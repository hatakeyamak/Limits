[signals]
# Names given to signal samples
#samples: T2tt_750_50
samples: T2tt_100_1, T2tt_100_25, T2tt_125_1, T2tt_125_25, T2tt_125_50, T2tt_150_1, T2tt_150_25, T2tt_150_50, T2tt_150_75, T2tt_175_100, T2tt_175_1, T2tt_175_25, T2tt_175_50, T2tt_175_75, T2tt_200_100, T2tt_200_125, T2tt_200_1, T2tt_200_25, T2tt_200_50, T2tt_200_75, T2tt_225_100, T2tt_225_125, T2tt_225_150, T2tt_225_25, T2tt_225_50, T2tt_225_75, T2tt_250_100, T2tt_250_125, T2tt_250_150, T2tt_250_175, T2tt_250_1, T2tt_250_50, T2tt_250_75, T2tt_275_100, T2tt_275_125, T2tt_275_150, T2tt_275_175, T2tt_275_200, T2tt_275_75, T2tt_300_100, T2tt_300_125, T2tt_300_150, T2tt_300_175, T2tt_300_1, T2tt_300_200, T2tt_300_225, T2tt_300_50, T2tt_325_125, T2tt_325_150, T2tt_325_175, T2tt_325_200, T2tt_325_225, T2tt_325_250, T2tt_350_100, T2tt_350_150, T2tt_350_175, T2tt_350_1, T2tt_350_200, T2tt_350_225, T2tt_350_250, T2tt_350_275, T2tt_350_50, T2tt_375_175, T2tt_375_200, T2tt_375_225, T2tt_375_250, T2tt_375_275, T2tt_375_300, T2tt_400_100, T2tt_400_150, T2tt_400_1, T2tt_400_200, T2tt_400_225, T2tt_400_250, T2tt_400_275, T2tt_400_300, T2tt_400_325, T2tt_400_50, T2tt_425_225, T2tt_425_250, T2tt_425_275, T2tt_425_300, T2tt_425_325, T2tt_425_350, T2tt_450_100, T2tt_450_150, T2tt_450_1, T2tt_450_200, T2tt_450_250, T2tt_450_275, T2tt_450_300, T2tt_450_325, T2tt_450_350, T2tt_450_375, T2tt_450_50, T2tt_475_275, T2tt_475_300, T2tt_475_325, T2tt_475_350, T2tt_475_375, T2tt_475_400, T2tt_500_100, T2tt_500_150, T2tt_500_1, T2tt_500_200, T2tt_500_250, T2tt_500_300, T2tt_500_325, T2tt_500_350, T2tt_500_375, T2tt_500_400, T2tt_500_425, T2tt_500_50, T2tt_525_325, T2tt_525_350, T2tt_525_375, T2tt_525_400, T2tt_525_425, T2tt_525_450, T2tt_550_100, T2tt_550_150, T2tt_550_1, T2tt_550_200, T2tt_550_250, T2tt_550_300, T2tt_550_350, T2tt_550_375, T2tt_550_400, T2tt_550_425, T2tt_550_450, T2tt_550_475, T2tt_550_50, T2tt_600_100, T2tt_600_150, T2tt_600_1, T2tt_600_200, T2tt_600_250, T2tt_600_300, T2tt_600_350, T2tt_600_400, T2tt_600_450, T2tt_600_50, T2tt_650_100, T2tt_650_150, T2tt_650_1, T2tt_650_200, T2tt_650_250, T2tt_650_300, T2tt_650_350, T2tt_650_400, T2tt_650_450, T2tt_650_50, T2tt_700_100, T2tt_700_150, T2tt_700_1, T2tt_700_200, T2tt_700_250, T2tt_700_300, T2tt_700_350, T2tt_700_400, T2tt_700_450, T2tt_700_50, T2tt_750_100, T2tt_750_150, T2tt_750_1, T2tt_750_200, T2tt_750_250, T2tt_750_300, T2tt_750_350, T2tt_750_400, T2tt_750_450, T2tt_750_50, T2tt_800_100, T2tt_800_150, T2tt_800_1, T2tt_800_200, T2tt_800_250, T2tt_800_300, T2tt_800_350, T2tt_800_400, T2tt_800_450, T2tt_800_50, T2tt_850_100, T2tt_850_150, T2tt_850_1, T2tt_850_200, T2tt_850_250, T2tt_850_300, T2tt_850_350, T2tt_850_400, T2tt_850_450, T2tt_850_50, T2tt_900_100, T2tt_900_150, T2tt_900_1, T2tt_900_200, T2tt_900_250, T2tt_900_300, T2tt_900_350, T2tt_900_400, T2tt_900_450, T2tt_900_50, T2tt_950_100, T2tt_950_150, T2tt_950_1, T2tt_950_200, T2tt_950_250, T2tt_950_300, T2tt_950_350, T2tt_950_400, T2tt_950_450, T2tt_950_50

[backgrounds]
# Names given to background samples
samples: ttbarplusw, znunu, ttZ, qcd

[control_regions]
# Names given to each control region for the uncertainties, and the corresponding samples to be used to estimate the yields in that CR
# Until we have data, the data yield will be based on MC (use the same filename for both dataFile and the first mcFile)
# files should be formated sampleName_crlabel
# Note that the variable names should be the same in the control region trees as in the signal region trees
# for external control regions to be applied with a transfer factor, the 'type' should be 'ext'
# for control regions to be fit simultaneously with the signal region, the 'type' should be 'fit'
# Three mcFiles are provided, comma-separated, the second one can be empty (''). The first is used to obtain the MC yield in the CR (transfer factor denominator). If a second mcFile is provided, this is treated as a background to be subtracted from the yield obtained from the dataFile. The third is used to obtain the MC yield in the SR (transfer factor numerator)
# The 'crwgt' and 'crsel' are the weight variable and selection to be used to obtain yields in the CR for data and MC, the 'srwgt' and 'srsel' are the weight variable and selection to be used to obtain yields in the CR for MC in the SR. If any of these are not provided, the baseline selection/weights will be used
# crName: {
#     'type' : <'ext'/'fit'>,
#     'dataFile' : <dataFileName>,
#     'mcFiles' : <crFileName,crSubFileName,srFileName>,
#     'crwgt' : <crwgtexpr>,
#     'crsel' : <crselexpr>,
#     'srwgt' : <srwgtexpr>,
#     'srsel' : <srselexpr>
#     }
zfromgamma: {
    'type' : 'ext',
    'dataFile' : 'data_photoncr',
    'mcFiles' : ['gjets_photoncr','','znunu'],
    'crwgt' : 'weight*truePUWeight*btagWeight*qcdRespTailWeight*(cttWeight*(ncttstd>0 && mtcsv12met>175) + 1.0*(ncttstd==0 || mtcsv12met<=175))',
    'crsel' : 'passcscbeamhaloflt && passeebadscflt && passeebadsc4flt && passhbheisoflt && passhbhefltloose && passjson && passtrigphoton165 && origmet<200 && met>250 && njets>=5 && j1pt>75 && j2pt>75 && nlbjets>=2 && nbjets>=1 && dphij12met>0.5 && dphij3met>0.5 && dphij4met>0.5',
    'srwgt' : 'weight*truePUWeight*btagWeight*leptnpweight*lepvetoweight*((0.94*(nbjets==1)) + (0.84*(nbjets>=2)))*qcdRespTailWeight*(cttWeight*(ncttstd>0 && mtcsv12met>175) + 1.0*(ncttstd==0 || mtcsv12met<=175))',
    'srsel' : 'nvetolep==0 && (nvetotau==0 || (ismc && npromptgentau>0)) && passcscbeamhaloflt && passeebadscflt && passeebadsc4flt && passhbheisoflt && passhbhefltloose && passjson && passdijetmet && met>250 && njets>=5 && j1pt>75 && j2pt>75 && nlbjets>=2 && nbjets>=1 && dphij12met>0.5 && dphij3met>0.5 && dphij4met>0.5'
    }
lostlep: {
    'type' : 'fit',
    'dataFile' : 'data_onelepcr',
    'mcFiles' : ['ttbarplusw_onelepcr','','ttbarplusw'],
    'crwgt' : 'weight*truePUWeight*btagWeight*btagFastSimWeight*leptnpweight*(cttWeight*(ncttstd>0 && mtcsv12met>175) + 1.0*(ncttstd==0 || mtcsv12met<=175))',
    'crsel' : 'passcscbeamhaloflt && passeebadscflt && passeebadsc4flt && passhbheisoflt && passhbhefltloose && passjson && passdijetmet && nvetolep>0 && mtlepmet<100 && met>250 && j1pt>75 && j2pt>75 && njets>=5 && nlbjets>=2 && nbjets>=1 && dphij12met>0.5 && dphij3met>0.5 && dphij4met>0.5',
    'srwgt' : 'weight*truePUWeight*btagWeight*btagFastSimWeight*leptnpweight*lepvetoweight*(cttWeight*(ncttstd>0 && mtcsv12met>175) + 1.0*(ncttstd==0 || mtcsv12met<=175))',
    'srsel' : '(nvetolep==0 && (nvetotau==0 || (ismc && npromptgentau>0)) && passcscbeamhaloflt && passeebadscflt && passeebadsc4flt && passhbheisoflt && passhbhefltloose && passjson && passdijetmet && met>250 && njets>=5 && j1pt>75 && j2pt>75 && nlbjets>=2 && nbjets>=1 && dphij12met>0.5 && dphij3met>0.5 && dphij4met>0.5'
    }
qcd: {
    'type' : 'ext',
    'dataFile' : 'data_qcdcr',
    'mcFiles' : ['qcd_qcdcr','nonqcd_qcdcr','qcd'],
    'crwgt' : 'weight*truePUWeight*btagWeight*qcdRespTailWeight*((leptnpweight*lepvetoweight*(qcdRespTailWeight == 1.0) + 1.0*(qcdRespTailWeight != 1.0)))*(cttWeight*(ncttstd>0 && mtcsv12met>175) + 1.0*(ncttstd==0 || mtcsv12met<=175))',
    'crsel' : 'passcscbeamhaloflt && passeebadscflt && passeebadsc4flt && passhbheisoflt && passhbhefltloose && passjson && passdijetmet && ((ismc && (qcdRespTailWeight!=1.0 || (qcdRespTailWeight==1.0 && nvetolep==0 && (nvetotau==0 || npromptgentau>0)))) || (!ismc && nvetolep==0 && nvetotau==0)) && met>250 && njets>=5 && j1pt>75 && j2pt>75 && nlbjets>=2 && nbjets>=1 && (dphij12met<0.1 || dphij3met<0.1)',
    'crsubsel' : 'passcscbeamhaloflt && passeebadscflt && passeebadsc4flt && passhbheisoflt && passhbhefltloose && passjson && passdijetmet && nvetolep==0 && ((ismc && (nvetotau==0 || npromptgentau>0)) || (!ismc && nvetotau==0)) && met>250 && njets>=5 && j1pt>75 && j2pt>75 && nlbjets>=2 && nbjets>=1 && (dphij12met<0.1 || dphij3met<0.1)',
    'crnormsel' : 'passcscbeamhaloflt && passeebadscflt && passeebadsc4flt && passhbheisoflt && passhbhefltloose && passjson && passdijetmet && nvetolep>0 && mtlepmet<100 && met>250 && j1pt>75 && j2pt>75 && njets>=5 && nlbjets>=2 && nbjets>=1 && dphij12met>0.5 && dphij3met>0.5 && dphij4met>0.5',
    'crnormwgt' : 'weight*truePUWeight*btagWeight*leptnpweight*(cttWeight*(ncttstd>0 && mtcsv12met>175) + 1.0*(ncttstd==0 || mtcsv12met<=175))',
    'srwgt' : 'weight*truePUWeight*btagWeight*qcdRespTailWeight*(cttWeight*(ncttstd>0 && mtcsv12met>175) + 1.0*(ncttstd==0 || mtcsv12met<=175))',
    'srsel' : 'passcscbeamhaloflt && passeebadscflt && passeebadsc4flt && passhbheisoflt && passhbhefltloose && passjson && passdijetmet && met>250 && njets>=5 && j1pt>75 && j2pt>75 && nlbjets>=2 && nbjets>=1 && dphij12met>0.5 && dphij3met>0.5 && dphij4met>0.5'
    }

[bins]
# Specify the binning here, using the appropriate variable names (from your trees)
# The numbers designate the bin edges. A + after the last value means the last bin will include everything greater than the last value
# Thus njets: 0, 1+ will result in the bins {0 <= njets < 1, njets >= 1}
5_1_0_0: {
   'cut': '(njets>=5 && njets<7) && nbjets==1 && mtcsv12met<175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }
5_2_0_0: {
   'cut': '(njets>=5 && njets<7) && nbjets>=2 && mtcsv12met<175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }
7_1_0_0: {
   'cut': '(njets>=7) && nbjets==1 && mtcsv12met<175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }
7_2_0_0: {
   'cut': '(njets>=7) && nbjets>=2 && mtcsv12met<175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }
5_1_0_175: {
   'cut': '(njets>=5 && njets<7) && nbjets==1 && ncttstd==0 && mtcsv12met>=175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }
5_2_0_175: {
   'cut': '(njets>=5 && njets<7) && nbjets>=2 && ncttstd==0 && mtcsv12met>=175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }
5_1_1_175: {
   'cut': '(njets>=5) && nbjets==1 && ncttstd>=1 && mtcsv12met>=175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }
5_2_1_175: {
   'cut': '(njets>=5) && nbjets>=2 && ncttstd>=1 && mtcsv12met>=175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }
7_1_0_175: {
   'cut': '(njets>=7) && nbjets==1 && ncttstd==0 && mtcsv12met>=175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }
7_2_0_175: {
   'cut': '(njets>=7) && nbjets>=2 && ncttstd==0 && mtcsv12met>=175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }


# Also specify the binning for each set of control regions, both external and simultaneous
[lostlep_bins]
5_1_0_0: {
   'cut': '(njets>=5 && njets<7) && nbjets>=1 && mtcsv12met<175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }
7_1_0_0: {
   'cut': '(njets>=7) && nbjets>=1 && mtcsv12met<175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }
5_1_0_175: {
   'cut': '(njets>=5 && njets<7) && nbjets>=1 && ncttstd==0 && mtcsv12met>=175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }
5_1_1_175: {
   'cut': '(njets>=5) && nbjets>=1 && ncttstd>=1 && mtcsv12met>=175',
   'var': 'met',
   'bin': [250, 1000]
   }
7_1_0_175: {
   'cut': '(njets>=7) && nbjets>=1 && ncttstd==0 && mtcsv12met>=175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }

[zfromgamma_bins]
5_1_0_0: {
   'cut': '(njets>=5 && njets<7) && nbjets>=1 && mtcsv12met<175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }
7_1_0_0: {
   'cut': '(njets>=7) && nbjets>=1 && mtcsv12met<175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }
5_1_0_175: {
   'cut': '(njets>=5 && njets<7) && nbjets>=1 && ncttstd==0 && mtcsv12met>=175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }
5_1_1_175: {
   'cut': '(njets>=5) && nbjets>=1 && ncttstd>=1 && mtcsv12met>=175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }
7_1_0_175: {
   'cut': '(njets>=7) && nbjets>=1 && ncttstd==0 && mtcsv12met>=175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }

[qcd_bins]
5_1_0_0: {
   'cut': '(njets>=5 && njets<7) && nbjets>=1 && mtcsv12met<175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }
7_1_0_0: {
   'cut': '(njets>=7) && nbjets>=1 && mtcsv12met<175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }
5_1_0_175: {
   'cut': '(njets>=5 && njets<7) && nbjets>=1 && ncttstd==0 && mtcsv12met>=175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }
5_1_1_175: {
   'cut': '(njets>=5) && nbjets>=1 && ncttstd>=1 && mtcsv12met>=175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }
7_1_0_175: {
   'cut': '(njets>=7) && nbjets>=1 && ncttstd==0 && mtcsv12met>=175',
   'var': 'met',
   'bin': [250, 300, 400, 500, 600, 1000]
   }

[config]
# Directory with root files. You must have one for each signal/background specified above! Plus one for data, if havedata is set to Yes
treelocation  = /eos/uscms/store/user/hqu/trees/050316_met250njets5
# Default datacard outputs go under this directory
datacarddir   = Datacards/results
# limit output stuff will go under this directory
limitdir      = Datacards/limits
# subdirectory to use under datacarddir and limitdir
subdir        = test
# Directory with configuration files (CR-> SR bin map, uncertainties, template datacard)
setuplocation = Datacards/setup
# Root file with stop pair cross sections
xsecfile = ../data/xsecs/stop.root
# Suffix of input root files
filesuffix    = _tree.root
# Datacard template with dummy values to be replaced, to be found in setuplocation
template      = datacard.txt_template
# Do we have data?
havedata      = Yes
# Blind the signal region?
blindsr       = No
# Whether to scale the signal yields to acceptance (i.e., cross section of 1 pb) or the reference cross section
scalesigtoacc = Yes
# Use dummy uncertainty values for signal/background
dummyuncertainties = No
# Print out all the uncertanties
printuncertainties = No
# If overwriting datacard dir, first rename and save existing dir
saveoverwrites = No
# File with names and types of uncertainties to apply, to be found in setuplocation
uncertainty_definitions = define_0l_uncs.conf
# Files specifying uncertainty values by bin start with this string
uncertainty_fileprefix = values_0l_unc
# File speficiying mapping from control regions to signal region
crtosr_bin_map = define_0l_binmap.conf
# method to calculate limits (current options: Asymptotic HybridNew ProfileLikelihood)
limitmethod  = AsymptoticLimits
# Name of your input TTrees
treename      = Events
# variable to project tree onto (for makeCutflowTables)
projvar       = met
# Name of your weight variable (for the SR)
weightname    = weight*truePUWeight*btagWeight*btagFastSimWeight*leptnpweight*lepvetoweight*qcdRespTailWeight*(cttWeight*(ncttstd>0 && mtcsv12met>175) + 1.0*(ncttstd==0 || mtcsv12met<=175))
# Luminosity to scale to (assumes default weights are scaled to 1 /fb)
lumiscale     = 2.317
# Baseline selection in terms of variables in input TTrees. Spaces are fine but don't put in quotes
basesel      = nvetolep==0 && (nvetotau==0 || (ismc && npromptgentau>0)) && passcscbeamhaloflt && passeebadscflt && passeebadsc4flt && passhbheisoflt && passhbhefltloose && passjson && passdijetmet && met>250 && j1pt>75 && j2pt>75 && njets>=5 && nlbjets>=2 && nbjets>=1 && dphij12met>0.5 && dphij3met>0.5 && dphij4met>0.5
